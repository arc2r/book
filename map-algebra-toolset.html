<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.1 Map Algebra Toolset | All things R Spatial</title>
  <meta name="description" content="7.1 Map Algebra Toolset | All things R Spatial" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7.1 Map Algebra Toolset | All things R Spatial" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.1 Map Algebra Toolset | All things R Spatial" />
  
  
  

<meta name="author" content="Nils Ratnaweera" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="image-analysis-toolbox.html"/>
<link rel="next" href="analysis-toolbox.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="making-maps.html"><a href="making-maps.html"><i class="fa fa-check"></i><b>2</b> Making Maps</a>
<ul>
<li class="chapter" data-level="2.1" data-path="static-maps.html"><a href="static-maps.html"><i class="fa fa-check"></i><b>2.1</b> Static Maps</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="static-maps.html"><a href="static-maps.html#prerequisit"><i class="fa fa-check"></i><b>2.1.1</b> Prerequisit</a></li>
<li class="chapter" data-level="2.1.2" data-path="static-maps.html"><a href="static-maps.html#static-maps-with-ggplot2"><i class="fa fa-check"></i><b>2.1.2</b> Static maps with <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>2.2</b> Interactive Maps</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="interactive-maps.html"><a href="interactive-maps.html#introduction-to-tmap"><i class="fa fa-check"></i><b>2.2.1</b> Introduction to <code>tmap</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-spatial-operations.html"><a href="basic-spatial-operations.html"><i class="fa fa-check"></i><b>3</b> Basic spatial operations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="clip-operation.html"><a href="clip-operation.html"><i class="fa fa-check"></i><b>3.1</b> Clip operation</a></li>
<li class="chapter" data-level="3.2" data-path="merge-operation.html"><a href="merge-operation.html"><i class="fa fa-check"></i><b>3.2</b> Merge operation</a></li>
<li class="chapter" data-level="3.3" data-path="buffer-operation.html"><a href="buffer-operation.html"><i class="fa fa-check"></i><b>3.3</b> Buffer operation</a></li>
<li class="chapter" data-level="3.4" data-path="select-by-attribute.html"><a href="select-by-attribute.html"><i class="fa fa-check"></i><b>3.4</b> Select by Attribute</a></li>
<li class="chapter" data-level="3.5" data-path="select-by-location.html"><a href="select-by-location.html"><i class="fa fa-check"></i><b>3.5</b> Select by Location</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-management-toolbox.html"><a href="data-management-toolbox.html"><i class="fa fa-check"></i><b>4</b> Data Management Toolbox</a>
<ul>
<li class="chapter" data-level="4.1" data-path="joins-toolset.html"><a href="joins-toolset.html"><i class="fa fa-check"></i><b>4.1</b> Joins Toolset</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="joins-toolset.html"><a href="joins-toolset.html#inner-join"><i class="fa fa-check"></i><b>4.1.1</b> Inner join</a></li>
<li class="chapter" data-level="4.1.2" data-path="joins-toolset.html"><a href="joins-toolset.html#outer-join"><i class="fa fa-check"></i><b>4.1.2</b> Outer join</a></li>
<li class="chapter" data-level="4.1.3" data-path="joins-toolset.html"><a href="joins-toolset.html#left-right-join"><i class="fa fa-check"></i><b>4.1.3</b> Left / Right join</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="projections-and-transformations-toolset.html"><a href="projections-and-transformations-toolset.html"><i class="fa fa-check"></i><b>4.2</b> Projections and Transformations Toolset</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="projections-and-transformations-toolset.html"><a href="projections-and-transformations-toolset.html#reproject-vector-data-in-r"><i class="fa fa-check"></i><b>4.2.1</b> Reproject vector data in R</a></li>
<li class="chapter" data-level="4.2.2" data-path="projections-and-transformations-toolset.html"><a href="projections-and-transformations-toolset.html#reproject-raster-data-in-r"><i class="fa fa-check"></i><b>4.2.2</b> Reproject raster data in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="projections-and-transformations-toolset.html"><a href="projections-and-transformations-toolset.html#generate-tessellation"><i class="fa fa-check"></i><b>4.2.3</b> Generate Tessellation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-analyst-toolbox.html"><a href="spatial-analyst-toolbox.html"><i class="fa fa-check"></i><b>5</b> Spatial Analyst Toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="conditional-toolset.html"><a href="conditional-toolset.html"><i class="fa fa-check"></i><b>5.1</b> Conditional Toolset</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="conditional-toolset.html"><a href="conditional-toolset.html#kernel-density"><i class="fa fa-check"></i><b>5.1.1</b> Kernel Density</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="reclass-toolset.html"><a href="reclass-toolset.html"><i class="fa fa-check"></i><b>5.2</b> Reclass Toolset</a></li>
<li class="chapter" data-level="5.3" data-path="surface-toolset.html"><a href="surface-toolset.html"><i class="fa fa-check"></i><b>5.3</b> Surface Toolset</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="surface-toolset.html"><a href="surface-toolset.html#slope-and-aspect"><i class="fa fa-check"></i><b>5.3.1</b> Slope and Aspect</a></li>
<li class="chapter" data-level="5.3.2" data-path="surface-toolset.html"><a href="surface-toolset.html#reclassify"><i class="fa fa-check"></i><b>5.3.2</b> Reclassify</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="d-analyst-toolbox.html"><a href="d-analyst-toolbox.html"><i class="fa fa-check"></i><b>6</b> 3D Analyst Toolbox</a>
<ul>
<li class="chapter" data-level="6.1" data-path="raster-interpolation-toolset.html"><a href="raster-interpolation-toolset.html"><i class="fa fa-check"></i><b>6.1</b> Raster Interpolation Toolset</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="raster-interpolation-toolset.html"><a href="raster-interpolation-toolset.html#idw"><i class="fa fa-check"></i><b>6.1.1</b> IDW</a></li>
<li class="chapter" data-level="6.1.2" data-path="raster-interpolation-toolset.html"><a href="raster-interpolation-toolset.html#kriging"><i class="fa fa-check"></i><b>6.1.2</b> Kriging</a></li>
<li class="chapter" data-level="6.1.3" data-path="raster-interpolation-toolset.html"><a href="raster-interpolation-toolset.html#natural-neighbor"><i class="fa fa-check"></i><b>6.1.3</b> Natural Neighbor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="image-analysis-toolbox.html"><a href="image-analysis-toolbox.html"><i class="fa fa-check"></i><b>7</b> Image Analysis Toolbox</a>
<ul>
<li class="chapter" data-level="7.1" data-path="map-algebra-toolset.html"><a href="map-algebra-toolset.html"><i class="fa fa-check"></i><b>7.1</b> Map Algebra Toolset</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="map-algebra-toolset.html"><a href="map-algebra-toolset.html#raster-calulator"><i class="fa fa-check"></i><b>7.1.1</b> Raster Calulator</a></li>
<li class="chapter" data-level="7.1.2" data-path="map-algebra-toolset.html"><a href="map-algebra-toolset.html#focal-statistics"><i class="fa fa-check"></i><b>7.1.2</b> Focal Statistics</a></li>
<li class="chapter" data-level="7.1.3" data-path="map-algebra-toolset.html"><a href="map-algebra-toolset.html#zonal-statistics"><i class="fa fa-check"></i><b>7.1.3</b> Zonal Statistics</a></li>
<li class="chapter" data-level="7.1.4" data-path="map-algebra-toolset.html"><a href="map-algebra-toolset.html#zonal-statistics-1"><i class="fa fa-check"></i><b>7.1.4</b> Zonal Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis-toolbox.html"><a href="analysis-toolbox.html"><i class="fa fa-check"></i><b>8</b> Analysis Toolbox</a>
<ul>
<li class="chapter" data-level="8.1" data-path="clip.html"><a href="clip.html"><i class="fa fa-check"></i><b>8.1</b> Clip</a></li>
<li class="chapter" data-level="8.2" data-path="merge.html"><a href="merge.html"><i class="fa fa-check"></i><b>8.2</b> Merge</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-join.html"><a href="spatial-join.html"><i class="fa fa-check"></i><b>8.3</b> Spatial Join</a></li>
<li class="chapter" data-level="8.4" data-path="buffer.html"><a href="buffer.html"><i class="fa fa-check"></i><b>8.4</b> Buffer</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="topology-rules.html"><a href="topology-rules.html"><i class="fa fa-check"></i><b>9</b> Topology Rules</a>
<ul>
<li class="chapter" data-level="9.1" data-path="polygon.html"><a href="polygon.html"><i class="fa fa-check"></i><b>9.1</b> Polygon</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="polygon.html"><a href="polygon.html#must-not-overlap"><i class="fa fa-check"></i><b>9.1.1</b> Must not overlap</a></li>
<li class="chapter" data-level="9.1.2" data-path="polygon.html"><a href="polygon.html#must-not-have-gaps"><i class="fa fa-check"></i><b>9.1.2</b> Must not have gaps</a></li>
<li class="chapter" data-level="9.1.3" data-path="polygon.html"><a href="polygon.html#contains-point"><i class="fa fa-check"></i><b>9.1.3</b> Contains point</a></li>
<li class="chapter" data-level="9.1.4" data-path="polygon.html"><a href="polygon.html#contains-one-point"><i class="fa fa-check"></i><b>9.1.4</b> Contains one Point</a></li>
<li class="chapter" data-level="9.1.5" data-path="polygon.html"><a href="polygon.html#must-be-covered-by-feature-class-of"><i class="fa fa-check"></i><b>9.1.5</b> Must be covered by feature class of</a></li>
<li class="chapter" data-level="9.1.6" data-path="polygon.html"><a href="polygon.html#boundary-must-be-covered-by"><i class="fa fa-check"></i><b>9.1.6</b> Boundary must be covered by</a></li>
<li class="chapter" data-level="9.1.7" data-path="polygon.html"><a href="polygon.html#must-not-overlap-with"><i class="fa fa-check"></i><b>9.1.7</b> Must not overlap with</a></li>
<li class="chapter" data-level="9.1.8" data-path="polygon.html"><a href="polygon.html#must-be-covered-by"><i class="fa fa-check"></i><b>9.1.8</b> Must be covered by</a></li>
<li class="chapter" data-level="9.1.9" data-path="polygon.html"><a href="polygon.html#area-boundary-must-be-covered-by-boundary-of"><i class="fa fa-check"></i><b>9.1.9</b> Area boundary must be covered by boundary of</a></li>
<li class="chapter" data-level="9.1.10" data-path="polygon.html"><a href="polygon.html#must-cover-each-other"><i class="fa fa-check"></i><b>9.1.10</b> Must cover each other</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">All things R Spatial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="map-algebra-toolset" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Map Algebra Toolset</h2>
<div id="raster-calulator" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Raster Calulator</h3>
<p>In GIS Softwares (ArcGIS pro, QGIS etc) <code>Raster Calculator</code> is one of the most
commonly used tools for performing various operations with raster datasets.</p>
<p>For the example below we will work with 2 datasets that depict India’s population at two different timestamps.
Our goal is to produce an output raster that demonstrates the evolvement of country’s
population in this 10 years timespan. Naturally in ArcGIS pro, the aforementioned operation
would be performed with the use of <code>Raster Calculator</code>. Let’s explore our options with R.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="map-algebra-toolset.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data for our example</span></span>
<span id="cb132-2"><a href="map-algebra-toolset.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb132-3"><a href="map-algebra-toolset.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># India&#39;s population in 2000</span></span>
<span id="cb132-4"><a href="map-algebra-toolset.html#cb132-4" aria-hidden="true" tabindex="-1"></a>india_2000 <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;sample_data/population_raster/india_2000.tif&quot;</span>)</span>
<span id="cb132-5"><a href="map-algebra-toolset.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># India&#39;s population in 2010</span></span>
<span id="cb132-6"><a href="map-algebra-toolset.html#cb132-6" aria-hidden="true" tabindex="-1"></a>india_2010 <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;sample_data/population_raster/india_2010.tif&quot;</span>)</span>
<span id="cb132-7"><a href="map-algebra-toolset.html#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="map-algebra-toolset.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb132-9"><a href="map-algebra-toolset.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(india_2000)</span>
<span id="cb132-10"><a href="map-algebra-toolset.html#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(india_2010)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>Let’s compute now the difference between the two rasters. To do so, there are various
options. As first we can create a function that performs a simple subtraction of two
rasters.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="map-algebra-toolset.html#cb133-1" aria-hidden="true" tabindex="-1"></a>diff_rasters <span class="ot">&lt;-</span> <span class="cf">function</span>(b1, b2){</span>
<span id="cb133-2"><a href="map-algebra-toolset.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this function calculates the difference between two rasters of the same CRS and extent</span></span>
<span id="cb133-3"><a href="map-algebra-toolset.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># input: 2 raster layers of the same extent, crs that can be subtracted</span></span>
<span id="cb133-4"><a href="map-algebra-toolset.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output: a single different raster of the same extent, crs of the input rasters</span></span>
<span id="cb133-5"><a href="map-algebra-toolset.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> b2 <span class="sc">-</span> b1</span>
<span id="cb133-6"><a href="map-algebra-toolset.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(diff)</span>
<span id="cb133-7"><a href="map-algebra-toolset.html#cb133-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Since, we created the function for subtracting one raster from another, we use now
the function <em>overlay</em> of the <code>raster</code> package for producing the new raster output.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="map-algebra-toolset.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the raster that depicts the difference in population in these 10 years</span></span>
<span id="cb134-2"><a href="map-algebra-toolset.html#cb134-2" aria-hidden="true" tabindex="-1"></a>pop2010_2000 <span class="ot">&lt;-</span> <span class="fu">overlay</span>(india_2000, india_2010,</span>
<span id="cb134-3"><a href="map-algebra-toolset.html#cb134-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fun =</span> diff_rasters)</span>
<span id="cb134-4"><a href="map-algebra-toolset.html#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="map-algebra-toolset.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pop2010_2000,</span>
<span id="cb134-6"><a href="map-algebra-toolset.html#cb134-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;India&#39;s population difference in the timespan of 10 years&quot;</span>,</span>
<span id="cb134-7"><a href="map-algebra-toolset.html#cb134-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<!-- ## Math Toolset -->
<!-- ## Overlay Toolset -->
<!-- ### Weighted Sum -->
<!-- ## Statistical Toolset -->
<!-- ### Cell Statistics -->
</div>
<div id="focal-statistics" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Focal Statistics</h3>
</div>
<div id="zonal-statistics" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Zonal Statistics</h3>
<blockquote>
<p><code>Focal statistics</code> performs a neighbourhood operation that computes an output raster, where the value for each output cell is a function of the values of all the input cells that are in a specified neighborhood around that location. The function performed on the input is a statistic, such as the maximum, average, or sum of all values encountered in that neighborhood.
Source: <a href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/how-focal-statistics-works.html" class="uri">https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/how-focal-statistics-works.html</a></p>
</blockquote>
<p>In R in order to apply functions focally to rasters, important is to define the neighbouring cells.
In other words to define the moving window for each of these functions. As an example below,
we will create our own raster object.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="map-algebra-toolset.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb135-2"><a href="map-algebra-toolset.html#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="map-algebra-toolset.html#cb135-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">ncol=</span><span class="dv">10</span>, <span class="at">nrow=</span><span class="dv">10</span>)</span>
<span id="cb135-4"><a href="map-algebra-toolset.html#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(r) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncell</span>(r)</span>
<span id="cb135-5"><a href="map-algebra-toolset.html#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r, <span class="at">main=</span><span class="st">&#39;Raster with 100 cells&#39;</span>, <span class="at">cex.main =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>We will recompute now the raster based on the <code>focal</code> function of the <code>raster</code> package. In the function
below, the neighbourhood for which we apply the statistic is represented by the argument <code>w</code>, while the
statistic by the argument <code>fun</code>.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="map-algebra-toolset.html#cb136-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">focal</span>(r, <span class="at">w=</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>),<span class="at">fun=</span>sum)</span>
<span id="cb136-2"><a href="map-algebra-toolset.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f1, <span class="at">main =</span> <span class="st">&quot;Raster after applying the focal function - raster package&quot;</span>, <span class="at">cex.main =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<p>The operation above can be also performed with the use of the <em>focal</em> function of the <strong>terra</strong> package.</p>
<ul>
<li><code>w</code> represents the moving window of the function. The window can be defined as one (for a square)
or two numbers (row, col); or with an odd-sized weights matrix. More details can be found here: <a href="https://rdrr.io/cran/terra/man/focal.html" class="uri">https://rdrr.io/cran/terra/man/focal.html</a></li>
<li><code>fun</code> represents the specified statistic for the identified neighbourhood (e.g mean,sum etc)</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="map-algebra-toolset.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb137-2"><a href="map-algebra-toolset.html#cb137-2" aria-hidden="true" tabindex="-1"></a>r_spat <span class="ot">&lt;-</span> <span class="fu">as</span>(r, <span class="st">&quot;SpatRaster&quot;</span>)</span>
<span id="cb137-3"><a href="map-algebra-toolset.html#cb137-3" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">focal</span>(r_spat,<span class="at">w=</span><span class="dv">3</span>,<span class="at">fun =</span> <span class="st">&quot;sum&quot;</span>)</span>
<span id="cb137-4"><a href="map-algebra-toolset.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f2, <span class="at">main =</span> <span class="st">&quot;Raster after applying the focal function - terra package&quot;</span>, <span class="at">cex.main =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
<div id="zonal-statistics-1" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Zonal Statistics</h3>
<p><code>Zonal Statistics</code> tool in ArcGIS pro is used for calculating the statistics
on values of a raster within the zones of another dataset. In R we are able to produce
similar results with the use of <code>zonal</code> function of the <code>raster</code> package.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="map-algebra-toolset.html#cb138-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">ncols=</span><span class="dv">10</span>, <span class="at">nrows=</span><span class="dv">10</span>)</span>
<span id="cb138-2"><a href="map-algebra-toolset.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generating random numbers that will used as values in our raster layer (r) - input values raster</span></span>
<span id="cb138-3"><a href="map-algebra-toolset.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(r) <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">ncell</span>(r)) <span class="sc">*</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncell</span>(r)</span>
<span id="cb138-4"><a href="map-algebra-toolset.html#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="map-algebra-toolset.html#cb138-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> r</span>
<span id="cb138-6"><a href="map-algebra-toolset.html#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co"># generating integer values for the raster layer z, which will be used as the zone raster</span></span>
<span id="cb138-7"><a href="map-algebra-toolset.html#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(z) <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each=</span><span class="dv">20</span>) </span>
<span id="cb138-8"><a href="map-algebra-toolset.html#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="map-algebra-toolset.html#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Zonal statistics - Summarize</span></span>
<span id="cb138-10"><a href="map-algebra-toolset.html#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="fu">zonal</span>(r, z, <span class="st">&quot;sum&quot;</span>)</span></code></pre></div>
<pre><code>##      zone       sum
## [1,]    1  99.58052
## [2,]    2 305.81367
## [3,]    3 475.71375
## [4,]    4 707.51735
## [5,]    5 796.50114</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="map-algebra-toolset.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zonal statistics - Mean</span></span>
<span id="cb140-2"><a href="map-algebra-toolset.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zonal</span>(r, z, <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<pre><code>##      zone      mean
## [1,]    1  4.979026
## [2,]    2 15.290684
## [3,]    3 23.785688
## [4,]    4 35.375867
## [5,]    5 39.825057</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="map-algebra-toolset.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zonal statistics - Minimum</span></span>
<span id="cb142-2"><a href="map-algebra-toolset.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zonal</span>(r, z, <span class="st">&quot;min&quot;</span>)</span></code></pre></div>
<pre><code>##      zone       min
## [1,]    1 0.1487266
## [2,]    2 1.9187318
## [3,]    3 3.1954170
## [4,]    4 4.5574448
## [5,]    5 2.8274044</code></pre>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="image-analysis-toolbox.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analysis-toolbox.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
