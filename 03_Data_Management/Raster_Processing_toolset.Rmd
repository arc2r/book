## Raster Processing Toolset

- [x] Clip Raster
- [ ] Composite Bands
- [ ] Compute Pansharpen Weights
- [ ] Create Ortho Corrected Raster Dataset
- [ ] Create Pansharpened Raster Dataset
- [ ] Extract Subdataset
- [ ] Generate Table From Raster Function
- [ ] Raster To DTED
- [ ] Resample <!-- duplicate! -->
- [ ] Split Raster

For this chapter, you will need the following R Packages:

```{r, echo = FALSE}
library(arc2r)
library(raster)
library(stars)
library(sf)
library(dplyr)
library(stars)
```

### Clip Raster

In GIS operations is quite common the necessity of "clipping" an area based on some specific region of interest. This is a quite useful and necessary procedure not only when we are dealing with vector datasets, but also when we have to work with raster ones. In ArcGIS pro the procedure of "cutting" a portion of a raster dataset, mosaic dataset, or an image service layer is performed using `Clip Raster` tool. In R, the respective operation can be performed using the _mask()_ function. For the example below, we are using the following datasets:

- __ARE_waedi__: Vector dataset that depicts the public transport connection quality in the city of Wädenswil
- __raster_recycling__: Dataset derived from the spatial interpolation of all the available "recycling points"in the city of Wädenwil  

<!--
/ todo: replcace this with arc2r/arc2r
/  assignees: KimboGilda
--> 

```{r echo=TRUE}

# Insert a vector dataset that depicts the public transport connection quality in
# the city of Wädenswil and plot it
ARE_waedi <- read_sf("sample_data/Entsorgung_Waedenswil/ARE_waedenswil.shp")
data("are_waedenswil")
# Read the raster dataset and plot it
raster_recycling <- raster("sample_data/Entsorgung_Waedenswil/abfall_raster.tif")
data("recycling_raster")
```

Plot the two datasets one over the other.
```{r, echo=FALSE}
plot(recycling_raster)
plot(are_waedenswil, alpha = 0.5, add = TRUE)
```

In our case, the vector dataset serves as the clipping extent for the clipping operation.
```{r Clip raster, echo=TRUE}
recycle_Waedi_clip <- mask(recycling_raster,are_waedenswil)
```


_Visualising the clipped output_
```{r echo=FALSE}
# ggplot() +
#   geom_stars(data = st_as_stars(recycle_Waedi_clip)) + 
#   scale_fill_gradientn(colours=c("green","yellow","red"))

plot(recycle_Waedi_clip)
```

