## Select by Location

```{r,echo=FALSE}
knitr::opts_chunk$set(warning = F, message = F, tidy = T)
library(dplyr)
library(sf)
library(ggplot2)
```
One of the most commonly used operations in ArcGIS pro is the process of selecting features of a spatial object (layer) based on whether or not these relate spatially to another object (layer). This process is also referred as _spatial subsetting_. In ArcGIS pro this can be preformed in various ways using the __Select by Location__ tool. 

In __R__ the same operation is, on a first level, performed using the _square bracket ([])_ operator from the base R package.

An example of spatial subsetting could be the following. Let's assume we have as a shapefile (polygon dataframe) with all the municipalities (Gemeinde) of the Canton of Zurich. Furthermore, we are also using a shapefile in the form of a point dataframe, which represents all the _"swimming spots"_ (Badenpl√§tze) in the same spatial region (Canton of Zurich). So, ultimately, our goal is to find out the "swimming spots" that lie within a specific municipality of the Canton of Zurich. 


```{r echo=T}
# Minicipalities (Gemeinde) in Canton Zurich
gemeinde_ZH <- st_read("sample_data/Kanton_Zuerich/Gemeinde_ZH.shp")

# "Swimming" spots in the Canton of Zurich
swimmSpots <- st_read("sample_data/Kanton_Zuerich/Badeplaetze_ZH.shp")
```

```{r, echo=F}
# Municipality (Gemeinde) of Richterswil 
richterswil <- dplyr::filter(gemeinde_ZH, gemeindena == "Richterswil")
names(richterswil)[5] = "Municipality"

ggplot() + geom_sf(data = gemeinde_ZH) + geom_sf(data = swimmSpots,color = "blue") + geom_sf(data = richterswil,aes(fill = Municipality)) + ggtitle("Swimming spots in the Canton of Zurich") + theme_minimal()
```

After importing and depicting the _swimming spots_ throughout the canton of Zurich, let's assume we want to check if and how many of them __lie within__ the Municipality of Richterswil. To do so, we will perform an operation, which belongs to the category of _Spatial subsetting_.

```{r}
swimmSpots_richt <- swimmSpots[richterswil, ,op = st_within]
```

```{r,echo=F}
ggplot() + geom_sf(data = gemeinde_ZH) + geom_sf(data = swimmSpots,color = "blue") + geom_sf(data = richterswil, fill = "white") + geom_sf(data = swimmSpots_richt, color = "red") + ggtitle("Swimming spots in the Canton of Zurich") + theme_minimal() 
```

