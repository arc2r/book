## Projections and Transformations Toolset

If there is anything special about spatial, it's the Coordinate Reference System. We will not get into the topic of CRS and Projections here, but it is advisable to get up to speed on this topic if you are dealing with geodata. From this toolset, we will cover the following tools:

- **Project**
- **Project Raster**
- **Define Projection**
- **Rescale** (Resizes a raster by the specified x and y scale factors)


### Define Projection

> Overwrites the coordinate system information (map projection and datum) stored with a dataset. This tool is intended for datasets that have an unknown or incorrect coordinate system defined.



### Project

> Projects spatial data from one coordinate system to another

For our example we will use the dataset `bezirke` from the package `arc2r`.

**R** and more specifically **sf package** offers options (functions) not only for transforming the coordinate system of a dataset, but also for identifying the current existing one. Let's dive in :)

```{r echo=TRUE, message=TRUE, warning=TRUE}
library(arc2r)
library(sf)


bezirke
```

```{r echo=TRUE, message=TRUE, warning=TRUE}
# Visualising the imported dataset
library(ggplot2)
ggplot() + geom_sf(data = bezirke)
```

In order to identify the current coordinate system of a dataset, **sf package**
offers the function _st_crs_. The main usage of the function is to retrieve the
coordinate reference system from an sf object.

```{r echo=TRUE, message=TRUE, warning=TRUE}
# retrieving the coordinate of the imported layer
st_crs(bezirke)
```
As an output we received that there is no assigned coordinate system to this
specific dataset. _st_set_crs_ function helps us assigning a coordinate system
to a dataset.

```{r echo=TRUE, message=TRUE, warning=TRUE}
# Assigning the World Geodetic System (WGS84) as a coordinate system to our dataset
bezirke <- st_set_crs(bezirke, 4326)
```
In the function above, the number 4326 represents the __EPSG Geodetic Parameter Dataset (EPSG)__
of the respective coordinate system. **EPSG** is a public registry of geodetic
datums, spatial reference systems, Earth ellipsoids, coordinate transformations
and related units of measurement.  

```{r echo=TRUE, message=TRUE, warning=TRUE}
st_crs(bezirke)
```
After rerunning the _st_crs_ function, we are getting now that the assigned
coordinate system of the dataset is World Geodetic System (WGS84).  
As a next step, we might want to transform the dataset to the Swiss coordinate system.
The respective **EPSG** for code for the latest Swiss coordinate system
(CH1903+LV95) is 2056. For this purpose we use the `st_transform` function of the **sf package**.


```{block2, type = "rmdnote"}
 _st_set_crs_ function **does not** reproject the coordinates of the given dataset. In other words, it does not affect the actual _geometry_ column of the sf object. _st_tranform_ on the other hand indeed **does indeed reproject** the dataset to another coordinate
```


```{r echo=TRUE, message=TRUE, warning=TRUE}
bezirke_swiss <- st_transform(bezirke, 2056)

# retrieve the coordinate system
st_crs(bezirke_swiss)
```


### Project Raster

> Transforms a raster dataset from one coordinate system to another

Working with Raster datasets in GIS of operations is of equal importance, as
working with vector ones. One of the spatial properties of raster datasets is the 
the Coordinate Reference System (CRS). CRS is the specific system that “associates”
the raster coordinates (which are just pairs of x/y values) to geographic locations.
In ArcGIS pro the tool for projecting a raster dataset is called
_Project Raster (Data Management)_. Let's see how we can perform the same operation
with R. 

```{r}
# Importing the datasets
library(raster)

# Dataset derived from the spatial interpolation of all the available "recycling points"
# in the city of Wädenwil
raster_recycling <- raster("sample_data/Raster/raster_recycling.tif") # CRS -> CH1903+LV95

# Dataset representing the public transport quality in the city of Wädenswil
publicTransport <- raster("sample_data/Raster/publicTransport_waedi.tif") # CRS -> WGS84 
```


```{r}
# Plot the raster dataset - World Geodetic System 1984 
plot(publicTransport,las=1,
     main = "Quality of public transport in the city of Wädenwil - CRS: WGS84",
     cex.main=1,font.main=4)
```

We can use the `projectRaster()` function to reproject a raster into a new CRS.
The first argument of the aforementioned function is the raster dataset we want to reproject,
while the second one is the dataset to whose projection we are targeting to. So, in
our case, we are targeting to the coordinate system of the __raster_recycling__
dataset.  
It is important to remember that raster reprojection only works when the raster
object has already a defined CRS.

```{r}
# Transform the coordinate system of the raster dataset publicTransport_CH
# into the Swiss Coordinate system - CH1903+LV95
publicTransport_CH = projectRaster(publicTransport, raster_recycling)
```

```{r}
# Plot the raster dataset - Swiss Coordinate System CH1903+LV95 
plot(publicTransport_CH,las=1,
     main = "Quality of public transport in the city of Wädenwil - CRS: CH1903+LV95",
     cex.main=1,font.main=4)
```










<!-- ## Topology Toolset -->

<!-- ## Sampling Toolset -->




























